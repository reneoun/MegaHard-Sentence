(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const c of e)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?c.credentials="include":e.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(e){if(e.ep)return;e.ep=!0;const c=o(e);fetch(e.href,c)}})();const d=new Map([[["Meta","Enter"],()=>{const n=document.querySelector("section[a4]:last-child"),t=n.cloneNode(!0);n.parentNode?.appendChild(t),t.scrollIntoView({behavior:"smooth"});const o=t.querySelector("div#editor");o&&(o.id=`editor-${Date.now()}`,o.addEventListener("keydown",a),o.textContent="",o.focus())}]]);function u(n){const t=window.getSelection();if(!t||t.rangeCount===0)return 0;const o=t.getRangeAt(0),r=o.cloneRange();return r.selectNodeContents(n),r.setEnd(o.endContainer,o.endOffset),r.toString().length}function l(n,t){const o=document.createRange(),r=window.getSelection();if(!r)return;const e=document.createTreeWalker(n,NodeFilter.SHOW_TEXT,null);let c=0,i;for(;i=e.nextNode();){const s=i.textContent?.length||0;if(c+s>=t){o.setStart(i,t-c),o.collapse(!0),r.removeAllRanges(),r.addRange(o);return}c+=s}o.selectNodeContents(n),o.collapse(!1),r.removeAllRanges(),r.addRange(o)}document.addEventListener("DOMContentLoaded",()=>{const n=document.querySelector("div#editor"),t=document.querySelector("section[a4]");if(t){const o=()=>{n&&n.focus()};t.addEventListener("click",o),t.addEventListener("touchstart",o)}n.addEventListener("keydown",a)});const a=n=>{d.forEach((o,r)=>{r.every(e=>n.getModifierState(e)||n.key===e)&&(n.preventDefault(),o())});const t=n.target;if(t){if(n.key==="Backspace"&&t.textContent===""){const e=t.closest("section[a4]");if(document.querySelectorAll("section[a4]").length>1&&e){e.remove();const s=document.querySelector("section[a4]:last-child").querySelector("div[contenteditable]");s&&s.focus()}}const o=u(t),r=t.textContent?.length||0;if((n.key==="ArrowUp"||n.key==="ArrowLeft")&&o===0){const e=t.parentElement?.previousElementSibling?.querySelector("div[contenteditable]");e&&(e.focus(),l(e,e.textContent?.length||0))}if((n.key==="ArrowDown"||n.key==="ArrowRight")&&o===r){const e=t.parentElement?.nextElementSibling?.querySelector("div[contenteditable]");e&&(e.focus(),l(e,0))}}};
